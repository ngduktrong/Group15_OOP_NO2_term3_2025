<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Quáº£n lÃ½ HÃ³a ÄÆ¡n</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<div class="container">
    <h1>ğŸ“„ Quáº£n lÃ½ HÃ³a ÄÆ¡n</h1>
    <div class="back-container">
    <a th:href="@{/admin/dashboard}">
        <button class="back-button">
            <i class="fas fa-arrow-left"></i> Quay láº¡i giao diá»‡n chÃ­nh
        </button>
    </a>
</div>

    <!-- âœ… ThÃ´ng bÃ¡o -->
    <p th:if="${message}" th:text="${message}" class="message" style="color: green;"></p>

    <!-- âœ… TÃ¬m kiáº¿m -->
    <form method="get" th:action="@{/hoadon}" class="form-inline" style="margin-bottom: 1em;">
        <input type="date" name="ngay" th:value="${searchDate}" placeholder="NgÃ y láº­p">
        <input type="number" name="maKH" th:value="${maKH}" placeholder="MÃ£ KH">
        <input type="date" name="tuNgay" th:value="${tuNgay}" placeholder="Tá»« ngÃ y">
        <input type="date" name="denNgay" th:value="${denNgay}" placeholder="Äáº¿n ngÃ y">
        <button type="submit">ğŸ” TÃ¬m</button>
    </form>

    <!-- âœ… Doanh thu -->
    <div th:if="${doanhThu != null}">
        <p>ğŸ’° Doanh thu ngÃ y [[${searchDate}]]: <strong>[[${doanhThu}]] Ä‘</strong></p>
    </div>
    <div th:if="${tongDoanhThuKhoang != null}">
        <p>ğŸ’° Doanh thu tá»« [[${tuNgay}]] Ä‘áº¿n [[${denNgay}]]: <strong>[[${tongDoanhThuKhoang}]] Ä‘</strong></p>
    </div>

    <!-- âœ… Form ThÃªm/Sá»­a HÃ³a ÄÆ¡n -->
    <h2 th:text="${hoaDon.maHoaDon} > 0 ? 'âœï¸ Sá»­a hÃ³a Ä‘Æ¡n' : 'â• ThÃªm hÃ³a Ä‘Æ¡n má»›i'"></h2>
    <form th:action="@{${hoaDon.maHoaDon} > 0 ? '/hoadon/update' : '/hoadon/add'}"
          method="post"
          th:object="${hoaDon}"
          class="form-inline"
          style="margin-bottom: 1em; gap: 1em; flex-wrap: wrap">

        <input type="hidden" th:field="*{maHoaDon}">

        <label>MÃ£ NV:</label>
        <input type="number" th:field="*{maNhanVien}" placeholder="MÃ£ NV" required>

        <label>MÃ£ KH:</label>
        <input type="number" th:field="*{maKhachHang}" placeholder="MÃ£ KH" required>

        <label>Tá»•ng tiá»n:</label>
        <input type="number" step="0.01" th:field="*{tongTien}" placeholder="Tá»•ng tiá»n" required>

        <!-- âœ… KhÃ´ng cáº§n nháº­p NgayLap vÃ¬ Ä‘Ã£ cáº­p nháº­t tá»± Ä‘á»™ng tá»« VÃ© -->
        <button type="submit" th:text="${hoaDon.maHoaDon} > 0 ? 'ğŸ’¾ Cáº­p nháº­t' : 'â• ThÃªm má»›i'"></button>
    </form>

    <!-- âœ… Danh sÃ¡ch HÃ³a Ä‘Æ¡n -->
    <h2>ğŸ“‹ Danh sÃ¡ch HÃ³a ÄÆ¡n</h2>
    <table border="1" style="width: 100%; border-collapse: collapse;">
        <thead style="background-color: #f2f2f2;">
        <tr>
            <th>ID</th>
            <th>MÃ£ NV</th>
            <th>MÃ£ KH</th>
            <th>NgÃ y láº­p</th>
            <th>Tá»•ng tiá»n</th>
            <th>HÃ nh Ä‘á»™ng</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="hd : ${hoaDonList}">
            <td th:text="${hd.maHoaDon}"></td>
            <td th:text="${hd.maNhanVien}"></td>
            <td th:text="${hd.maKhachHang}"></td>
            <td th:text="${hd.ngayLap}"></td>
            <td th:text="${#numbers.formatDecimal(hd.tongTien, 1, 'COMMA', 2, 'POINT')} + ' Ä‘'"></td>
            <td>
                <a th:href="@{'/hoadon/edit/' + ${hd.maHoaDon}}">âœï¸</a>
                <form th:action="@{/hoadon/delete}" method="post" style="display:inline;">
                    <input type="hidden" name="maHoaDon" th:value="${hd.maHoaDon}">
                    <button type="submit" onclick="return confirm('Báº¡n cháº¯c cháº¯n muá»‘n xÃ³a?')">ğŸ—‘ï¸</button>
                </form>
            </td>
        </tr>
        <tr th:if="${hoaDonList.empty}">
            <td colspan="6" style="text-align: center;">KhÃ´ng cÃ³ hÃ³a Ä‘Æ¡n nÃ o.</td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>
