<!-- src/main/resources/templates/phim/list.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>üé¨ Danh s√°ch Phim</title>
    <link rel="stylesheet" th:href="@{/css/phim.css}" />
</head>
<body>
<div class="container">
    <h2 class="tieude">üé¨ Danh s√°ch Phim trong h·ªá th·ªëng</h2>
    <div class="center">
        <a class="ThemPhim" th:href="@{/phim/add}">Th√™m phim m·ªõi</a>
    </div>

    <table class="DanhSachPhim">
        <thead>
            <tr>
                <th>M√£ Phim</th>
                <th>Ti√™u ƒë·ªÅ</th>
                <th>Th·ªùi l∆∞·ª£ng</th>
                <th>Ng√†y kh·ªüi chi·∫øu</th>
                <th>N∆∞·ªõc SX</th>
                <th>ƒê·ªãnh d·∫°ng</th>
                <th>ƒê·∫°o di·ªÖn</th>
                <th>M√¥ t·∫£</th>
                <th>Poster</th>
                <th>H√†nh ƒë·ªông</th>
            </tr>
        </thead>
        <tbody>
            <!-- Duy·ªát qua danh s√°ch phims -->
            <tr th:each="phim : ${phims}">
                <td th:text="${phim.maPhim}">1</td>
                <td th:text="${phim.tenPhim}">T√™n phim</td>
                <td th:text="${phim.thoiLuong} + ' ph√∫t'">120 ph√∫t</td>
                <td th:text="${phim.ngayKhoiChieu}">2025-01-01</td>
                <td th:text="${phim.nuocSanXuat}">Vi·ªát Nam</td>
                <td th:text="${phim.dinhDang}">2D</td>
                <td th:text="${phim.daoDien}">ƒê·∫°o di·ªÖn</td>
                <td>
                    <span class="truncate"
                          th:title="${phim.moTa}"
                          th:text="${#strings.abbreviate(phim.moTa, 30)}">
                        M√¥ t·∫£...
                    </span>
                </td>
                <td>
                    <img class="poster"
                         th:if="${phim.duongDanPoster != null and phim.duongDanPoster != ''}"
                         th:src="@{${phim.duongDanPoster}}"
                         alt="Poster" />
                    <span th:if="${phim.duongDanPoster == null or phim.duongDanPoster == ''}">
                        Ch∆∞a c√≥
                    </span>
                </td>
                <td>
                    <a th:href="@{|/phim/edit/${phim.maPhim}|}">S·ª≠a</a> |
                    <a href="#"
                       class="delete-link"
                       th:attr="data-delete-url=@{|/phim/delete/${phim.maPhim}|}">
                        X√≥a
                    </a>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Khi danh s√°ch r·ªóng -->
    <p th:if="${#lists.isEmpty(phims)}" class="empty-message">
        Kh√¥ng c√≥ d·ªØ li·ªáu phim ƒë·ªÉ hi·ªÉn th·ªã.
    </p>
</div>

<!-- Inline JS cho X√≥a v√† Redirect v·ªÅ list -->
<script th:inline="javascript">
  document.querySelectorAll('.delete-link').forEach(function(a) {
    a.addEventListener('click', function(e) {
      e.preventDefault();
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a phim n√†y?')) {
        // G·ªçi GET /phim/delete/{id}
        fetch(a.getAttribute('data-delete-url'), { method: 'GET' })
          .then(() => window.location.href = /*[[ @{/phim/list} ]]*/ '/phim/list');
      }
    });
  });
</script>
</body>
</html>
