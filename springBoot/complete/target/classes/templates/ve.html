<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Qu·∫£n l√Ω V√©</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        body { font-family: Arial; margin: 30px; background-color: #f5f5f5; }
        h1 { color: #2c3e50; }
        .container { max-width: 1000px; margin: auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
        .form-group { margin: 10px 0; }
        input, select { padding: 5px; width: 100%; }
        .actions { display: flex; gap: 10px; justify-content: center; }
        .message { margin: 10px 0; font-weight: bold; }
        .success { color: green; }
        .error { color: red; }
        .btn { padding: 6px 12px; border: none; cursor: pointer; border-radius: 5px; }
        .btn-edit { background-color: #3498db; color: white; }
        .btn-delete { background-color: #e74c3c; color: white; }
        .btn-submit { background-color: #2ecc71; color: white; }
    </style>
</head>
<body>
<div class="container">
    <h1>üé´ Qu·∫£n l√Ω V√©</h1>

    <div th:if="${message}" class="message" th:classappend="${message.startsWith('‚úÖ')} ? ' success' : ' error'">
        <span th:text="${message}"></span>
    </div>

    <!-- Form Th√™m ho·∫∑c S·ª≠a -->
    <form th:action="@{${editMode} ? '/ve/edit' : '/ve/add'}" method="post">
        <input type="hidden" th:if="${editMode}" th:field="*{ve.maVe}"/>

        <div class="form-group">
            <label>M√£ Su·∫•t Chi·∫øu:</label>
            <input type="number" th:field="*{ve.maSuatChieu}" th:readonly="${editMode}" required />
        </div>

        <div class="form-group">
            <label>M√£ Ph√≤ng:</label>
            <input type="number" th:field="*{ve.maPhong}" required />
        </div>

        <div class="form-group">
            <label>S·ªë Gh·∫ø:</label>
            <input type="text" th:field="*{ve.soGhe}" th:readonly="${editMode and ve.trangThai != 'Ch∆∞a thanh to√°n'}" required />
        </div>

        <div class="form-group">
            <label>M√£ H√≥a ƒê∆°n:</label>
            <input type="number" th:field="*{ve.maHoaDon}" required />
        </div>

        <div class="form-group">
            <label>Gi√° V√©:</label>
            <input type="number" step="0.01" th:field="*{ve.giaVe}" required />
        </div>

        <div class="form-group">
            <label>Tr·∫°ng Th√°i:</label>
            <select th:field="*{ve.trangThai}">
                <option value="Ch∆∞a thanh to√°n">Ch∆∞a thanh to√°n</option>
                <option value="ƒê√£ thanh to√°n">ƒê√£ thanh to√°n</option>
            </select>
        </div>

        <!-- ‚úÖ ƒê√£ ƒë·ªïi sang datetime-local -->
        <div class="form-group">
            <label>Ng√†y ƒê·∫∑t:</label>
            <input type="datetime-local" th:field="*{ve.ngayDat}" required />
        </div>

        <button type="submit" class="btn btn-submit" th:text="${editMode} ? 'C·∫≠p nh·∫≠t' : 'Th√™m m·ªõi'"></button>
        <a th:if="${editMode}" th:href="@{/ve}" class="btn">H·ªßy</a>
    </form>

    <!-- Danh s√°ch v√© -->
    <table>
        <thead>
        <tr>
            <th>M√£ V√©</th>
            <th>M√£ Su·∫•t Chi·∫øu</th>
            <th>M√£ Ph√≤ng</th>
            <th>S·ªë Gh·∫ø</th>
            <th>M√£ H√≥a ƒê∆°n</th>
            <th>Gi√° V√©</th>
            <th>Tr·∫°ng Th√°i</th>
            <th>Ng√†y ƒê·∫∑t</th>
            <th>Thao t√°c</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="ve : ${veList}">
            <td th:text="${ve.maVe}">1</td>
            <td th:text="${ve.maSuatChieu}">101</td>
            <td th:text="${ve.maPhong}">5</td>
            <td th:text="${ve.soGhe}">A1</td>
            <td th:text="${ve.maHoaDon}">202</td>
            <td th:text="${ve.giaVe}">75000</td>
            <td th:text="${ve.trangThai}">Ch∆∞a thanh to√°n</td>
            <td th:text="${ve.ngayDat}">2025-07-01T10:30</td>
            <td class="actions">
                <form th:action="@{/ve/edit/{id}(id=${ve.maVe})}" method="get" th:if="${ve.trangThai == 'Ch∆∞a thanh to√°n'}">
                    <button type="submit" class="btn btn-edit">‚úèÔ∏è</button>
                </form>
                <form th:action="@{/ve/delete/{id}(id=${ve.maVe})}" method="post" onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° v√© n√†y?');">
                    <button type="submit" class="btn btn-delete">üóëÔ∏è</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>
